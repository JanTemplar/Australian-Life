RPP_fnc_employee_openDialog ={	private ["_corporation", "_dlg"];	_corporation = _this select 0;	_dlg = createDialog "DlgEmployeeOpen";		_corporation call RPP_fnc_employee_LoadDialog;};RPP_fnc_employee_LoadDialog ={	private ["_corporation", "_employees"];	_corporation = _this;	_employees = _corporation call RPP_fnc_employee_getEmployees;		lbClear 2203;	lbClear 2204;		{		_firstName = ((_x select 0) select 0);		_lastName = ((_x select 0) select 1);		_accessLevel = (_x select 1);				_index = lbAdd[2203, format["%1 %2 : %3", _firstName, _lastName, (_accessLevel call RPP_fnc_employee_getAccessString)]];	} forEach _employees;	lbSetCurSel [2203, 0];		{		_index = lbAdd[2204, format["%1", (_x call RPP_fnc_employee_getAccessString)]];		lbSetData[2204, _index, str _x];	} forEach (call RPP_fnc_employee_getAccessArray);	lbSetCurSel [2204, 0];		((findDisplay 2201) displayCtrl 2205) buttonSetAction format["'%1' call RPP_fnc_employee_Add;", _corporation];	((findDisplay 2201) displayCtrl 2206) buttonSetAction format["'%1' call RPP_fnc_employee_del;", _corporation];};RPP_fnc_employee_del ={		private ["_corporation", "_firstName", "_lastName"];	_corporation = _this;	_firstName = ctrlText 2201;	_lastName = ctrlText 2202;		if ([_corporation, [_firstName, _lastName]] call RPP_fnc_employee_exists) then	{		_employees = employees getVariable "employees";		_found = false;		{			if (_x select 0 == _corporation) exitWith			{				_i = 0;				_arr = (_x select 1);				{						if (str [_firstName, _lastName] == str (_x select 0)) then					{						_found = true;					};										if (_found) exitWith					{						_arr set[_i,"DELETE"];						_arr = _arr - ["DELETE"];					};				_i = _i + 1;				} forEach (_x select 1);								if (_found) exitWith				{					_x set[1,_arr];					_found = false;				};			};		} forEach _employees;					employees setVariable["employees", _employees, true];		[TNL_gVar_str_tables_employees, [employees], [ [_employees, "employees"] ]] call TNL_fsav_clientRequestSave;		_corporation call RPP_fnc_employee_LoadDialog;	};};RPP_fnc_employee_add ={	private ["_corporation", "_firstName", "_lastName", "_accessLevel", "_update"];	_corporation = _this;	_firstName = ctrlText 2201;	_lastName = ctrlText 2202;	_accessLevel = parseNumber lbData[2204, lbCurSel 2204];	_update = false;		if ([_corporation, [_firstName, _lastName]] call RPP_fnc_employee_exists) then	{		_update = true;	};	if (not (_corporation call RPP_fnc_employee_corpExists)) then	{		_employees = employees getVariable "employees";		_employees set[(count _employees), [_corporation, []]];		employees setVariable["employees", _employees, true];	};			_employees = employees getVariable "employees";	{		if (_x select 0 == _corporation) exitWith		{			if (_update) then			{				{					if (str [_firstName, _lastName] == str (_x select 0)) exitWith					{						_x set[1,_accessLevel];					};				} forEach (_x select 1);			}			else			{				(_x select 1) set[(count (_x select 1)), [ [_firstName,_lastName],_accessLevel ]];			};		};	} forEach _employees;	employees setVariable["employees", _employees, true];	[TNL_gVar_str_tables_employees, [employees], [ [_employees, "employees"] ]] call TNL_fsav_clientRequestSave;	_corporation call RPP_fnc_employee_LoadDialog;};RPP_fnc_employee_getAccessLevel ={	private ["_corporation", "_name", "_result", "_employees"];	_corporation = _this select 0;	_name = _this select 1;	_result = -1;	_employees = _corporation call RPP_fnc_employee_getEmployees;		if (count _employees != 0) then	{		{			if (str _name == str (_x select 0)) exitWith			{				_result = _x select 1;			};		} forEach _employees;	};		_result};RPP_fnc_employee_corpExists ={	private ["_corp", "_result"];	_corp = _this;	_result = false;		if (count (_corporation call RPP_fnc_employee_getEmployees) == 0) then	{		_result = false;	}	else	{		_result = true;	};		_result};RPP_fnc_employee_exists ={	private ["_corporation", "_employeeName", "_result"];	_corporation = _this select 0;	_employeeName = _this select 1;	_result = false;		{		if (str (_x select 0) == str(_employeeName)) exitWith		{			_result = true;		};		} forEach (_corporation call RPP_fnc_employee_getEmployees);	_result};RPP_fnc_employee_getAccessArray ={	private ["_return"];	_return = [ 0,1,2 ];	_return};RPP_fnc_employee_getAccessString ={	private ["_accessLevel", "_return"];	_accessLevel = _this;	_return = "";		switch (_accessLevel) do	{		case 0:		{			_return = "Limited";		};		case 1:		{			_return = "Manager";		};		case 2:		{			_return = "Full";		};		default		{			_return = "Error";		};	};	_return};RPP_fnc_employee_getEmployees ={	private ["_corporation", "_result"];	_corporation = _this;	_result = [];		{		if (_x select 0 == _corporation) exitWith		{			_result = (_x select 1);		};	} forEach (employees getVariable "employees");	_result};